<!-- VIRTUAL SCROLL LIST -->
<kirby-virtual-scroll-list
  *ngIf="isVirtualScrollEnabled"
  [slidingItemTemplate]="slidingItemTemplate"
>
</kirby-virtual-scroll-list>

<!-- Normal List -->
<kirby-normal-list
  *ngIf="!isVirtualScrollEnabled"
  [slidingItemTemplate]="slidingItemTemplate"
></kirby-normal-list>

<!-- Item templates -->
<ng-template #defaultItemTemplate let-item>
  <ng-container
    *ngTemplateOutlet="
      hasDeprecatedItemTemplate ? deprecatedItemTemplate : itemTemplate;
      context: { $implicit: item }
    "
  ></ng-container>
</ng-template>

<ng-template #deprecatedItemTemplate let-item>
  <ion-item
    [button]="isSelectable ? true : null"
    [attr.tabindex]="isSelectable ? null : 0"
    detail="false"
  >
    <ng-container
      *ngTemplateOutlet="legacyItemTemplate; context: { $implicit: item }"
    ></ng-container>
    <ng-container
      *ngTemplateOutlet="legacyFlexItemTemplate; context: { $implicit: item }"
    ></ng-container>
  </ion-item>
</ng-template>

<!-- Swipe Action templates -->
<ng-template #slidingItemTemplate let-item>
  <ion-item-sliding
    [class.selected]="isSelectable && item === selectedItem"
    [kirbyListItemColor]="getItemColor"
    [item]="item"
    [disabled]="isSwipingEnabled ? null : true"
    [ngClass]="getOrderClasses(item)"
    keyHandler
    (click)="isSelectable ? onItemSelect(item) : null"
  >
    <ng-container
      *ngTemplateOutlet="swipeActionsTemplate; context: { $implicit: item }"
    ></ng-container>
    <ng-container
      *ngTemplateOutlet="defaultItemTemplate; context: { $implicit: item }"
    ></ng-container>
  </ion-item-sliding>
</ng-template>

<ng-template #swipeActionsTemplate let-item>
  <ion-item-options
    *ngIf="getSwipeActionsSide('left', item) && getSwipeActionsSide('left', item).length > 0"
    side="start"
  >
    <ng-container
      *ngTemplateOutlet="
        swipeActionTemplate;
        context: { $implicit: item, swipeActions: getSwipeActionsSide('left', item) }
      "
    ></ng-container>
  </ion-item-options>

  <ion-item-options
    *ngIf="getSwipeActionsSide('right', item) && getSwipeActionsSide('right', item).length > 0"
    side="end"
  >
    <ng-container
      *ngTemplateOutlet="
        swipeActionTemplate;
        context: { $implicit: item, swipeActions: getSwipeActionsSide('right', item) }
      "
    ></ng-container>
  </ion-item-options>
</ng-template>

<ng-template #swipeActionTemplate let-item let-swipeActions="swipeActions">
  <div class="swipe-action">
    <ng-container *ngFor="let swipeAction of swipeActions">
      <ion-item-option
        [ngClass]="getSwipeActionType(swipeAction, item)"
        (click)="onSwipeActionSelect(swipeAction, item, $event)"
      >
        <div class="item-content">
          <kirby-icon
            *ngIf="getSwipeActionIcon(swipeAction, item)"
            size="sm"
            [name]="getSwipeActionIcon(swipeAction, item)"
          >
          </kirby-icon>
          <ion-label>
            {{ getSwipeActionTitle(swipeAction, item) }}
          </ion-label>
        </div>
      </ion-item-option>
    </ng-container>
  </div>
</ng-template>
