<ion-virtual-scroll
  *ngIf="!listComponent.isSectionsEnabled"
  [items]="listComponent.items"
  class="list"
  [trackBy]="listComponent.trackBy || listComponent.defaultTrackBy"
  kirbyInfiniteScroll
  [itemHeight]="listComponent.itemHeightFn"
  (scrollEnd)="listComponent.onLoadOnDemand()"
  [disabled]="!listComponent.isLoadOnDemandEnabled"
  [class.has-header]="listComponent.headerTemplate"
  [headerFn]="listComponent.headerFn"
  [footerFn]="listComponent.footerFn"
  [class.has-footer]="listComponent.footerTemplate"
  [class.has-divider]="listComponent.showDivider"
  (window:resize)="listComponent.onResize(slidingItem?.ionItemSliding?.closeOpened)"
  #list
>
  <ion-list-header *virtualHeader="let header">
    <ng-container *ngTemplateOutlet="listComponent.headerTemplate"></ng-container>
  </ion-list-header>

  <kirby-sliding-item *virtualItem="let item" [item]="item"> </kirby-sliding-item>

  <div *virtualFooter="let footer" class="footer">
    <ng-container *ngTemplateOutlet="listComponent.footerTemplate"></ng-container>
  </div>
</ion-virtual-scroll>

<!-- Virtual scroll list with sections -->
<ion-virtual-scroll
  *ngIf="listComponent.isSectionsEnabled && listComponent.sortedItems"
  [items]="listComponent.sortedItems"
  class="list"
  [trackBy]="listComponent.trackBy || listComponent.defaultTrackBy"
  kirbyInfiniteScroll
  [itemHeight]="listComponent.itemHeightFn"
  (scrollEnd)="listComponent.onLoadOnDemand()"
  [disabled]="!listComponent.isLoadOnDemandEnabled"
  [class.has-header]="listComponent.headerTemplate"
  [headerFn]="listComponent.sectionHeaderFn"
  [footerFn]="listComponent.footerFn"
  [class.has-footer]="listComponent.footerTemplate"
  [class.has-divider]="listComponent.showDivider"
  (window:resize)="listComponent.onResize(slidingItem?.ionItemSliding?.closeOpened)"
  #list
>
  <ng-container *virtualHeader="let header">
    <ion-item-divider>
      <ng-container
        *ngTemplateOutlet="listComponent.sectionHeaderTemplate; context: { $implicit: header }"
      ></ng-container>
    </ion-item-divider>
  </ng-container>

  <kirby-sliding-item *virtualItem="let item" [item]="item"> </kirby-sliding-item>

  <ng-container *virtualFooter="let footer">
    <div class="footer">
      <ng-container *ngTemplateOutlet="listComponent.footerTemplate"></ng-container>
    </div>
  </ng-container>
</ion-virtual-scroll>
